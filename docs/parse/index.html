<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link href="https://valwv.github.io/apartments/css/style.css" rel="stylesheet">
<link type="text/css" href="https://valwv.github.io/apartments/parse/cards.css" rel="stylesheet">
</head>


  <body>
<div class="row data__sims"></div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>

<script>
function getWaitTimes(){
  $("error").html('loading....');
  $.ajax({
    type: "GET",
    url: "https://raw.githubusercontent.com/ValWV/apartments/master/docs/parse/Feed_2.xml",
    dataType: "xml",
    success: function(xml){
      $xml = $(xml);
      $($xml).find('realty-feed>offer').each(function(){
        var id = $(this).find('id').eq(0).text();
        var idType = $(this).find('type').eq(0).text();
        var id2 = $(this).find('ID').eq(1).text();
        var idType2 = $(this).find('Type').eq(1).text();
        var Name = $(this).find('address').text();
        var averageWaitTime = Math.round($(this).find('AverageWaitTime').text()/60);
        var longestWait = Math.round($(this).find('LongestCurrentWaitTime').text()/60);
        var price = $(this).find('price>value').text();
        var readyquarter = $(this).find('ready-quarter').text();
        var area = $(this).find('area>value').text();
        var lspace = $(this).find('living-space>value').text();
        var floor = $(this).find('floor').text();
        var floorstotal = $(this).find('floors-total').text();
        var totalPatients = $(this).find('image[tag="plan"]:first').text();
        var htmlOutPut = ''+
          '<div class="col-md-3">'+
            '<div class="card card-2" data-toggle="modal" data-target="#mymodal4">'+
            '<div class="card__top">'+
                      '<img class="card-img-top" src="'+totalPatients+'">'+
            '</div>'+
            
            '<div class="card__body">'+
              '<h4>'+Name+'</h4>'+
              '<h5 data-animation="animated flipInX" class="m-b-10 m-t-0">'+price+'</h5>'+
              '<div class="text-info m-b-0">'+longestWait+'RUB</div>'+          
            '</div>'+
            '<div class="card__bottom text-center">'+
            '<div class="card__action">'+
                '<span class="specifiaction text-muted">Срок сдачи</span>'+
                '<div class="m-b-0 font-medium">'+readyquarter+'</div>'+
            '</div>'+
            '<div class="card__action">'+
                '<span class="specifiaction text-muted">Общая площадь</span>'+
                '<div class="m-b-0 font-medium">'+area+'</div>'+
            '</div>'+
            '<div class="card__action">'+
                '<span class="specifiaction text-muted">Жилья площадь</span>'+
                '<div class="m-b-0 font-medium">'+lspace+'</div>'+
            '</div>'+
            '<div class="card__action">'+
                '<span class="specifiaction text-muted">Этаж</span>'+
                '<div class="m-b-0 font-medium">'+floor+'из'+floorstotal+'</div>'+
            '</div>'+
            '</div>'+
         
          '</div>'+


          '<div id="mymodal4" class="modal fade custom-modal modal5" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">'+
                                    '<div class="modal-dialog modal-lg">'+
                                        '<div class="modal-content">'+
                                            '<div class="modal-header">'+
                                                '<h4 class="modal-title"></h4>'+
                                                '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>'+
                                            '</div>'+
                                            '<div class="modal-body">'+
                                                
                                            '</div>'+
                                            '<div class="modal-footer">'+

                                            '</div>'+
                                        '</div>'+
                                    '</div>'+
                                '</div>'+
          
          '</div>'+
        '';
        $('.data__sims').append(htmlOutPut);
      });
    },
    error: function(err){
      $('.error').html('error: '+err);
    }
  });
}

$(document).ready(function() {
  getWaitTimes();
});


</script>
  </body>

</html>
